import{Cc as d,Gc as u,Nc as b,W as l,_ as s,a as i,b as a,k as c}from"./chunk-LE4ENPVO.js";var y=class r{constructor(e,t,o){this.focusMonitor=e;this.liveAnnouncer=t;this.platform=o;this.loadUserPreferences(),this.detectKeyboardNavigation()}ACCESS_STORAGE_KEY="findbook-accessibility-preferences";accessibilityState=new c({highContrast:!1,reducedMotion:this.hasReducedMotion(),largeText:!1,keyboardNavigation:!1,screenReader:this.hasScreenReader()});accessibilityState$=this.accessibilityState.asObservable();announce(e,t="polite"){this.liveAnnouncer.announce(e,t)}toggleHighContrast(){let e=this.accessibilityState.value,t=a(i({},e),{highContrast:!e.highContrast});this.updateAccessibilityState(t),this.applyHighContrastStyles(t.highContrast),this.announce(t.highContrast?"High contrast mode enabled":"High contrast mode disabled")}toggleLargeText(){let e=this.accessibilityState.value,t=a(i({},e),{largeText:!e.largeText});this.updateAccessibilityState(t),this.applyLargeTextStyles(t.largeText),this.announce(t.largeText?"Large text mode enabled":"Large text mode disabled")}toggleReducedMotion(){let e=this.accessibilityState.value,t=a(i({},e),{reducedMotion:!e.reducedMotion});this.updateAccessibilityState(t),this.applyReducedMotionStyles(t.reducedMotion),this.announce(t.reducedMotion?"Reduced motion enabled":"Reduced motion disabled")}getCurrentState(){return this.accessibilityState.value}focusElement(e){let t=document.getElementById(e);t&&(t.focus(),this.announce(`Focused on ${t.getAttribute("aria-label")||t.textContent||e}`))}trapFocus(e){this.focusMonitor.focusVia(e,"keyboard")}isVisibleToScreenReader(e){let t=getComputedStyle(e);return!(t.display==="none"||t.visibility==="hidden"||e.hasAttribute("aria-hidden")||e.getAttribute("aria-hidden")==="true")}validateAriaAttributes(e){let t=[];return e.hasAttribute("role")&&!e.hasAttribute("aria-label")&&!e.hasAttribute("aria-labelledby")&&t.push("Element with role should have aria-label or aria-labelledby"),e.tagName.toLowerCase()==="div"&&e.hasAttribute("onclick")&&t.push('Clickable div should be a button or have role="button"'),t}hasReducedMotion(){return this.platform.isBrowser?window.matchMedia("(prefers-reduced-motion: reduce)").matches:!1}hasScreenReader(){return this.platform.isBrowser?!!(window.speechSynthesis||navigator.userAgent.includes("NVDA")||navigator.userAgent.includes("JAWS")||navigator.userAgent.includes("VoiceOver")):!1}detectKeyboardNavigation(){if(!this.platform.isBrowser)return;let e=!1;document.addEventListener("keydown",t=>{if(t.key==="Tab"){e=!0;let o=this.accessibilityState.value;o.keyboardNavigation||(this.updateAccessibilityState(a(i({},o),{keyboardNavigation:!0})),this.applyKeyboardNavigationStyles(!0))}}),document.addEventListener("mousedown",()=>{if(e){e=!1;let t=this.accessibilityState.value;t.keyboardNavigation&&(this.updateAccessibilityState(a(i({},t),{keyboardNavigation:!1})),this.applyKeyboardNavigationStyles(!1))}})}updateAccessibilityState(e){this.accessibilityState.next(e),this.saveUserPreferences(e)}loadUserPreferences(){if(this.platform.isBrowser)try{let e=localStorage.getItem(this.ACCESS_STORAGE_KEY);if(e){let t=JSON.parse(e),o=this.accessibilityState.value,n=i(i({},o),t);this.accessibilityState.next(n),this.applyAllStyles(n)}}catch(e){console.warn("Failed to load accessibility preferences:",e)}}saveUserPreferences(e){if(this.platform.isBrowser)try{localStorage.setItem(this.ACCESS_STORAGE_KEY,JSON.stringify(e))}catch(t){console.warn("Failed to save accessibility preferences:",t)}}applyAllStyles(e){this.applyHighContrastStyles(e.highContrast),this.applyLargeTextStyles(e.largeText),this.applyReducedMotionStyles(e.reducedMotion),this.applyKeyboardNavigationStyles(e.keyboardNavigation)}applyHighContrastStyles(e){this.platform.isBrowser&&(e?document.body.classList.add("high-contrast"):document.body.classList.remove("high-contrast"))}applyLargeTextStyles(e){this.platform.isBrowser&&(e?document.body.classList.add("large-text"):document.body.classList.remove("large-text"))}applyReducedMotionStyles(e){this.platform.isBrowser&&(e?document.body.classList.add("reduced-motion"):document.body.classList.remove("reduced-motion"))}applyKeyboardNavigationStyles(e){this.platform.isBrowser&&(e?document.body.classList.add("keyboard-navigation"):document.body.classList.remove("keyboard-navigation"))}static \u0275fac=function(t){return new(t||r)(s(u),s(b),s(d))};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};export{y as a};
