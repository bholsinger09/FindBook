<div class="book-details-container" *ngIf="book">
  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <mat-spinner diameter="50"></mat-spinner>
    <p class="loading-message">Loading book details...</p>
  </div>

  <!-- Book Details Content -->
  <div class="book-details-content" *ngIf="!isLoading">
    <!-- Header with close button -->
    <div class="details-header">
      <h2 class="details-title">Book Details</h2>
      <button mat-icon-button 
              class="close-button" 
              (click)="close()" 
              aria-label="Close book details">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <mat-divider></mat-divider>

    <!-- Main content -->
    <div class="details-body">
      <!-- Book cover and basic info -->
      <div class="book-header">
        <div class="book-cover">
          <img [src]="getImageUrl()" 
               [alt]="book.title + ' cover'"
               class="cover-image">
        </div>
        
        <div class="book-basic-info">
          <h1 class="book-title">{{ book.title }}</h1>
          <p class="book-authors">
            <mat-icon class="info-icon">person</mat-icon>
            {{ formatAuthors(book.authors) }}
          </p>
          
          <p class="book-publisher" *ngIf="book.publisher">
            <mat-icon class="info-icon">business</mat-icon>
            {{ book.publisher }}
          </p>
          
          <p class="book-published-date" *ngIf="book.publishedDate">
            <mat-icon class="info-icon">calendar_today</mat-icon>
            {{ book.publishedDate }}
          </p>

          <p class="book-page-count">
            <mat-icon class="info-icon">book</mat-icon>
            {{ formatPageCount(book.pageCount) }}
          </p>

          <p class="book-language" *ngIf="book.language">
            <mat-icon class="info-icon">language</mat-icon>
            {{ book.language | uppercase }}
          </p>
        </div>
      </div>

      <!-- Rating -->
      <div class="book-rating" *ngIf="book.averageRating">
        <mat-icon class="rating-icon">star</mat-icon>
        <span class="rating-text">{{ formatRating(book.averageRating, book.ratingsCount) }}</span>
      </div>

      <!-- Categories -->
      <div class="book-categories" *ngIf="book.categories && book.categories.length > 0">
        <h3 class="section-title">Categories</h3>
        <div class="categories-container">
          <mat-chip-set>
            <mat-chip *ngFor="let category of book.categories" class="category-chip">
              {{ category }}
            </mat-chip>
          </mat-chip-set>
        </div>
      </div>

      <!-- Description -->
      <div class="book-description" *ngIf="book.description">
        <h3 class="section-title">Description</h3>
        <p class="description-text" [innerHTML]="book.description"></p>
      </div>

      <!-- Action buttons -->
      <div class="action-buttons">
        <button mat-raised-button 
                color="primary"
                class="preview-button"
                [disabled]="!book.webReaderLink"
                (click)="requestPreview()">
          <mat-icon>visibility</mat-icon>
          Preview Book
        </button>

        <button mat-raised-button 
                [color]="isFavorite ? 'accent' : 'primary'"
                class="favorite-button"
                (click)="toggleFavorite()">
          <mat-icon>{{ isFavorite ? 'favorite' : 'favorite_border' }}</mat-icon>
          {{ isFavorite ? 'Remove from Favorites' : 'Add to Favorites' }}
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Empty state -->
<div class="no-book-message" *ngIf="!book && !isLoading">
  <mat-icon class="no-book-icon">book</mat-icon>
  <p>No book selected</p>
</div>